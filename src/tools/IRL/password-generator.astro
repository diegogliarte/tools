---
import InputCheckbox from "@components/InputCheckbox.astro";
import InputFieldNumber from "@components/InputFieldNumber.astro";
import ResultDisplay from "@components/ResultDisplay.astro";

export const tool = {
    title: "Password Generator",
    description: "Generate secure random passwords (all client-side)",
};
---

<section class="max-w-xl mx-auto text-center space-y-8">
    <div id="password-form" class="space-y-6 text-left">
        <InputFieldNumber id="length" label="Length" placeholder="16" value="16" min={1} max={65536} step={1} />

        <div class="grid grid-cols-2 gap-3">
            <InputCheckbox id="lowercase" label="Lowercase (a-z)" checked />
            <InputCheckbox id="uppercase" label="Uppercase (A-Z)" checked />
            <InputCheckbox id="numbers"   label="Numbers (0-9)" checked />
            <InputCheckbox id="symbols"   label="Symbols (!@#$...)" checked />
        </div>
    </div>

    <div class="text-left">
        <ResultDisplay id="passwordValue" label="Password" copiable variant="field" />
    </div>

</section>

<script>
    const $password = document.getElementById("passwordValue");

    function generatePassword() {
        const lowercase = document.getElementById("lowercase").checked;
        const uppercase = document.getElementById("uppercase").checked;
        const numbers   = document.getElementById("numbers").checked;
        const symbols   = document.getElementById("symbols").checked;

        const sets = [];
        if (lowercase) sets.push("abcdefghijklmnopqrstuvwxyz");
        if (uppercase) sets.push("ABCDEFGHIJKLMNOPQRSTUVWXYZ");
        if (numbers)   sets.push("0123456789");
        if (symbols)   sets.push("!@#$%^&*()-_=+[]{};:,.<>?");

        if (sets.length === 0) {
            $password.textContent = "â€”";
            return;
        }

        const lengthInput = document.getElementById("length");
        const length = parseInt(lengthInput.value || lengthInput.placeholder) || 16;

        const allChars = sets.join("");
        let result = "";
        for (let i = 0; i < length; i++) {
            const rnd = Math.floor(Math.random() * allChars.length);
            result += allChars[rnd];
        }
        $password.textContent = result;
    }

    document.getElementById("password-form").addEventListener("input", generatePassword);

    generatePassword();
</script>